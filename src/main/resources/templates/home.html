<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>LocalChat — Home</title>
</head>
<body>

<h1>LocalChat</h1>
<p>Анонимный чат в локальной сети</p>

<p>
    <strong>Ваш UUID:</strong>
    <span id="uuid" th:text="${uuid}"></span>
</p>

<p>
    <strong>Ваш никнейм:</strong>
    <span id="nickname">загрузка...</span>
</p>

<button onclick="goToChat()">Перейти в чат</button>

<script>
    const uuid = document.getElementById("uuid").innerText;

    fetch("/api/users", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({ uuid })
    })
    .then(r => r.json())
    .then(user => {
        document.getElementById("nickname").innerText = user.nickname;
    })
    .catch(() => {
        document.getElementById("nickname").innerText = "ошибка";
    });

    function goToChat() {
        window.location.href = "/chat";
    }
</script>

</body>
</html>
